<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bay Area Future/Planned Transit Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        #map {
            height: 100vh;
            width: 100vw;
        }
        .legend {
            background: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            line-height: 24px;
            font-size: 14px;
            max-height: 80vh;
            overflow-y: auto;
        }
        .legend-title {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 10px;
        }
        .legend-item {
            margin: 5px 0;
        }
        .legend-line {
            display: inline-block;
            width: 30px;
            height: 3px;
            margin-right: 8px;
            vertical-align: middle;
        }
        /* Editable style variables */
        :root {
            --bart-extension: #FF1493;
            --muni-expansion: #9370DB;
            --vta-future: #FF6347;
            --caltrain-future: #FF8C00;
            --smart-extension: #32CD32;
            --valley-link: #4169E1;
            --new-station: #FFD700;
            --line-weight: 4;
            --station-size: 7;
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <script>
        // Initialize map centered on Bay Area
        const map = L.map('map').setView([37.7749, -122.2194], 10);

        // Add OpenStreetMap tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '© OpenStreetMap contributors'
        }).addTo(map);

        // Future/Planned Transit Projects

        // BART Extensions
        const bartExtensions = [
            // Silicon Valley Phase II (Berryessa to Santa Clara)
            {coords: [[37.3696, -121.8743], [37.3297, -121.9017], [37.3541, -121.9552], [37.3521, -121.9365]], name: "BART Silicon Valley Phase II (To Santa Clara, 2037)", type: "bart"},
            // Irvington Station Extension
            {coords: [[37.5281, -121.9763], [37.5281, -121.9763]], name: "Irvington BART Station (2031)", type: "bart"}
        ];

        // Caltrain Improvements
        const caltrainFuture = [
            // Bayview Infill Station
            {coords: [[37.7070, -122.4030], [37.7070, -122.4030]], name: "Bayview Caltrain Station (Planned)", type: "caltrain"},
            // High-Speed Rail Connection (long-term)
            {coords: [[37.7764, -122.3943], [37.3299, -121.9017]], name: "Caltrain/High-Speed Rail Corridor", type: "caltrain"}
        ];

        // Muni Metro Expansions
        const muniFuture = [
            // Geneva-Harney BRT (becomes future rail corridor)
            {coords: [[37.7191, -122.4425], [37.7062, -122.4698]], name: "Geneva-Harney Corridor (Future)", type: "muni"},
            // Central Subway Extension (North Beach/Fisherman's Wharf)
            {coords: [[37.7989, -122.4070], [37.8080, -122.4177]], name: "Central Subway Extension to North Beach", type: "muni"},
            // Geary BRT to Rail Conversion (potential)
            {coords: [[37.7817, -122.5133], [37.7863, -122.4079]], name: "Geary Corridor Rail (Potential)", type: "muni"}
        ];

        // VTA Future Improvements
        const vtaFuture = [
            // BART-VTA Connection Enhancement
            {coords: [[37.3696, -121.8743], [37.3541, -121.9552]], name: "VTA-BART Enhanced Connection", type: "vta"},
            // Frequency improvements on existing lines
            {coords: [[37.3541, -121.9552], [37.3944, -122.0768]], name: "VTA Frequency Improvements (Phase 1)", type: "vta"}
        ];

        // SMART Extension
        const smartFuture = [
            // Windsor to Healdsburg Extension
            {coords: [[38.5088, -122.8009], [38.6097, -122.8693]], name: "SMART Extension to Healdsburg", type: "smart"}
        ];

        // Valley Link
        const valleyLink = [
            // Dublin/Pleasanton BART to Mountain House
            {coords: [[37.7018, -121.8996], [37.8260, -121.5654]], name: "Valley Link Initial Segment (Dublin-Mountain House)", type: "valley"}
        ];

        // Future Stations
        const futureStations = [
            // BART Silicon Valley Phase II Stations
            {coords: [37.3351, -121.8866], name: "28th St/Little Portugal BART (2037)", type: "bart"},
            {coords: [37.3341, -121.8881], name: "Downtown San José BART (2037)", type: "bart"},
            {coords: [37.3297, -121.9017], name: "Diridon BART Station (2037)", type: "bart"},
            {coords: [37.3521, -121.9365], name: "Santa Clara BART (2037)", type: "bart"},
            // Irvington BART
            {coords: [37.5281, -121.9763], name: "Irvington BART (2031)", type: "bart"},
            // Caltrain Infill
            {coords: [37.7070, -122.4030], name: "Bayview Caltrain (Planned)", type: "caltrain"},
            // Muni Extensions
            {coords: [37.8080, -122.4177], name: "North Beach Muni Station (Planned)", type: "muni"},
            // SMART Extension
            {coords: [38.6097, -122.8693], name: "Healdsburg SMART (Planned)", type: "smart"},
            // Valley Link
            {coords: [37.8260, -121.5654], name: "Mountain House Valley Link (Planned)", type: "valley"}
        ];

        // Style functions
        function getLineStyle(type) {
            const styles = {
                'bart': {color: getComputedStyle(document.documentElement).getPropertyValue('--bart-extension').trim() || '#FF1493', weight: 4, opacity: 0.8, dashArray: '10, 10'},
                'caltrain': {color: getComputedStyle(document.documentElement).getPropertyValue('--caltrain-future').trim() || '#FF8C00', weight: 4, opacity: 0.8, dashArray: '10, 10'},
                'muni': {color: getComputedStyle(document.documentElement).getPropertyValue('--muni-expansion').trim() || '#9370DB', weight: 4, opacity: 0.8, dashArray: '10, 10'},
                'vta': {color: getComputedStyle(document.documentElement).getPropertyValue('--vta-future').trim() || '#FF6347', weight: 4, opacity: 0.8, dashArray: '10, 10'},
                'smart': {color: getComputedStyle(document.documentElement).getPropertyValue('--smart-extension').trim() || '#32CD32', weight: 4, opacity: 0.8, dashArray: '10, 10'},
                'valley': {color: getComputedStyle(document.documentElement).getPropertyValue('--valley-link').trim() || '#4169E1', weight: 4, opacity: 0.8, dashArray: '10, 10'}
            };
            return styles[type] || {color: '#000', weight: 3, opacity: 0.7, dashArray: '10, 10'};
        }

        function getStationColor(type) {
            const colors = {
                'bart': '#FF1493',
                'caltrain': '#FF8C00',
                'muni': '#9370DB',
                'smart': '#32CD32',
                'valley': '#4169E1'
            };
            return colors[type] || '#FFD700';
        }

        // Draw all planned routes
        [...bartExtensions, ...caltrainFuture, ...muniFuture, ...vtaFuture, ...smartFuture, ...valleyLink].forEach(route => {
            L.polyline(route.coords, getLineStyle(route.type))
                .bindPopup(`<b>${route.name}</b><br>Status: Planned`)
                .addTo(map);
        });

        // Draw future stations
        futureStations.forEach(station => {
            L.circleMarker(station.coords, {
                radius: 7,
                fillColor: getStationColor(station.type),
                color: '#fff',
                weight: 2,
                opacity: 1,
                fillOpacity: 0.9
            }).bindPopup(`<b>${station.name}</b><br>Status: Planned`).addTo(map);
        });

        // Add legend
        const legend = L.control({position: 'bottomright'});
        legend.onAdd = function(map) {
            const div = L.DomUtil.create('div', 'legend');
            div.innerHTML = `
                <div class="legend-title">Future/Planned Transit</div>
                <div class="legend-item">
                    <span class="legend-line" style="background: var(--bart-extension, #FF1493); border-top: 3px dashed var(--bart-extension, #FF1493);"></span>
                    BART Extensions
                </div>
                <div class="legend-item">
                    <span class="legend-line" style="background: var(--caltrain-future, #FF8C00); border-top: 3px dashed var(--caltrain-future, #FF8C00);"></span>
                    Caltrain Improvements
                </div>
                <div class="legend-item">
                    <span class="legend-line" style="background: var(--muni-expansion, #9370DB); border-top: 3px dashed var(--muni-expansion, #9370DB);"></span>
                    Muni Metro Expansions
                </div>
                <div class="legend-item">
                    <span class="legend-line" style="background: var(--vta-future, #FF6347); border-top: 3px dashed var(--vta-future, #FF6347);"></span>
                    VTA Future Improvements
                </div>
                <div class="legend-item">
                    <span class="legend-line" style="background: var(--smart-extension, #32CD32); border-top: 3px dashed var(--smart-extension, #32CD32);"></span>
                    SMART Extension
                </div>
                <div class="legend-item">
                    <span class="legend-line" style="background: var(--valley-link, #4169E1); border-top: 3px dashed var(--valley-link, #4169E1);"></span>
                    Valley Link
                </div>
                <div style="margin-top: 10px; font-size: 12px; font-style: italic;">
                    Dashed lines indicate planned projects
                </div>
            `;
            return div;
        };
        legend.addTo(map);
    </script>
</body>
</html>